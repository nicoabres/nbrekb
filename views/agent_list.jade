extends layout

block content
	.row
		.col-md-12
			h2 Agent List
	table.table.table-dark.table-hover.table-striped
		thead
			tr
				th Agent Name
				th Corporation
				th Kills
				th Losses
		tbody
				if agents.docs.length
					for agent in agents.docs
						- var totalKills = 0
						- var totalLosses = 0
						for kill in kills
							if agent.id == kill.agentID
								- totalLosses++
							for attacker in kill.attackers
								if agent.id == attacker._embedded.agent.id
									- totalKills++
						tr
							td 
								a(href='/agents?id=#{agent.id}') #{agent.name}
							td 
								a(href='/corporations?id=#{agent.corporation.id}') #{agent.corporation.name}
							td #{totalKills}
							td #{totalLosses}
	.row.float-right
		.col-md-12
			nav
				ul.pagination.float-right
					if agents.hasPrevPage
						li.page-item
							a.page-link(href='/agents?page=1&limit=10') First
						li.page-item
							a.page-link(href='/agents?page=#{agents.page - 1}&limit=10') <<
					if agents.page >= 4
						li.page-item
							a.page-link(href='/agents?page=#{agents.page - 3}&limit=10') #{agents.page - 3}
					if agents.page >= 3
						li.page-item
							a.page-link(href='/agents?page=#{agents.page - 2}&limit=10') #{agents.page - 2}
					if agents.page >= 2
						li.page-item
							a.page-link(href='/agents?page=#{agents.page - 1}&limit=10') #{agents.page - 1}
					li.page-item.active
						a.page-link(href='/agents?page=#{agents.page}&limit=10') #{agents.page}
					if agents.page <= agents.totalPages - 1
						li.page-item
							a.page-link(href='/agents?page=#{agents.page + 1}&limit=10') #{agents.page + 1}
					if agents.page <= agents.totalPages - 2
						li.page-item
							a.page-link(href='/agents?page=#{agents.page + 2}&limit=10') #{agents.page + 2}
					if agents.page <= agents.totalPages - 3
						li.page-item
							a.page-link(href='/agents?page=#{agents.page + 3}&limit=10') #{agents.page + 3}
					if agents.hasNextPage
						li.page-item
							a.page-link(href='/agents?page=#{agents.page + 1}&limit=10') >>
						li.page-item
							a.page-link(href='/agents?page=#{agents.totalPages}&limit=10') Last
			p.float-right Total Agents: #{agents.totalDocs}