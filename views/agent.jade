extends layout

block content
	.row
		.col-md-4
			table.table.table-dark.table-hover.table-striped
				tbody
					tr
						th Agent Name
						td #{agentInfo.name}
					tr
						th Corporation
						td #{agentInfo.corporation.name}
		.col-md-8
			table.table.table-dark.table-hover.table-striped
				thead
					tr
						th
						th Destroyed
						th Lost
						th Efficiency
				tbody
					tr
						th Bots
						td #{totalKills}
						td #{totalLosses}
						td #{totalKills / kills.docs.length}%

	.row
		.col-md-12
			h2 Recent Activity
			table.table.table-dark.table-hover.table-striped
				thead
					tr
						th Time
						th Bot
						th Zone
						th Victim
						th Final Blow
				tbody
					for kill in kills.docs
						if kill.agentID == agentInfo.id
							tr(style="background-color:#ff634785")
								td #{moment(kill.date).format('YYYY-MM-DD HH:mm:ss')}
								td 
									if kill.robot.name.includes('MK2')
										- var robotName = kill.robot.name
										- robotName = robotName.replace(' MK2', '')
										- robotName = robotName.toLowerCase()
										a(href='/robots?id=#{kill.robot.id}')
											img.rounded-sm(src='/images/icon_mech_#{robotName}_mk2_mini.png', alt='#{kill.robot.name')
									else if kill.robot.name.includes(' PR')
										- var robotName = kill.robot.name
										- robotName = robotName.replace(' PR', '')
										- robotName = robotName.toLowerCase()
										img.rounded-sm(src='/images/icon_mech_#{robotName}_pr_mini.png', alt='#{kill.robot.name}')
									else
										a(href='/robots?id=#{kill.robot.id}')
											img.rounded-sm(src='/images/icon_mech_#{kill.robot.name}_mini.png', alt='#{kill.robot.name}')
								td
									a(href='/zones?id=#{kill.zone.id}') #{kill.zone.name}
								td
									a(href='/agents?id=#{kill.agent.id}') #{kill.agent.name} (#{kill.robot.name})
									br
									a(href='/corporations?id=#{kill.corporation.id}') #{kill.corporation.name}
								-var i = 0
								each attacker in kill.attackers
									- i++
								for attacker in kill.attackers
									if attacker.hasKillingBlow
										td 
											a(href='/agents?id=#{attacker._embedded.agent.id}') #{attacker._embedded.agent.name} (#{i})
											br
											a(href='/corporations?id=#{attacker._embedded.corporation.id}') #{attacker._embedded.corporation.name}
						else
							tr(style="background-color:#77dd7782")
								td #{moment(kill.date).format('YYYY-MM-DD HH:mm:ss')}
								td 
									if kill.robot.name.includes('MK2')
										- var robotName = kill.robot.name
										- robotName = robotName.replace(' MK2', '')
										- robotName = robotName.toLowerCase()
										img.rounded-sm(src='/images/icon_mech_#{robotName}_mk2_mini.png', alt='#{kill.robot.name')
									else
										img.rounded-sm(src='/images/icon_mech_#{kill.robot.name}_mini.png', alt='#{kill.robot.name}')
								td
									a(href='/zones?id=#{kill.zone.id}') #{kill.zone.name}
								td
									a(href='/agents?id=#{kill.agent.id}') #{kill.agent.name} (#{kill.robot.name})
									br
									a(href='/corporations?id=#{kill.corporation.id}') #{kill.corporation.name}
								-var i = 0
								each attacker in kill.attackers
									- i++
								for attacker in kill.attackers
									if attacker.hasKillingBlow
										td
											a(href='/agents?id=#{attacker._embedded.agent.id}') #{attacker._embedded.agent.name} (#{i})
											br
											a(href='/corporations?id=#{attacker._embedded.corporation.id}') #{attacker._embedded.corporation.name}

			.row.float-right
				.col-md-12				
					nav.pull-right(aria-label='Page navigation example')
							ul.pagination
								if kills.hasPrevPage
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=1&limit=10') First
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page - 1}&limit=10') <<
								if kills.page >= 4
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page - 3}&limit=10') #{kills.page - 3}
								if kills.page >= 3
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page - 2}&limit=10') #{kills.page - 2}
								if kills.page >= 2
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page - 1}&limit=10') #{kills.page - 1}
								li.page-item.active
									a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page}&limit=10') #{kills.page}
								if kills.page <= kills.totalPages - 1
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page + 1}&limit=10') #{kills.page + 1}
								if kills.page <= kills.totalPages - 2
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page + 2}&limit=10') #{kills.page + 2}
								if kills.page <= kills.totalPages - 3
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page + 3}&limit=10') #{kills.page + 3}
								if kills.hasNextPage
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.page + 1}&limit=10') >>
									li.page-item
										a.page-link(href='/agents?id=#{agentInfo.id}&page=#{kills.totalPages}&limit=10') Last
					p Total Kills: #{kills.totalDocs}
