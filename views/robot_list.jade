extends layout

block content
	h2 Robot List
	table.table.table-dark.table-hover.table-striped
		thead
			tr
				th(style='width: 5%')
				th Robot Name
				th Kills
				th Losses
		tbody
			if robots.docs.length
				for robot in robots.docs
					- var totalKills = 0
					- var totalLosses = 0
					for kill in kills
						if robot.id == kill.robotID
							- totalLosses++
						for attacker in kill.attackers
							if robot.id == attacker._embedded.robot.id
								- totalKills++
					if !robot.name
						tr
							td
								a(href='/robots?id=#{robot.id}') Missing name!
					else
						tr
							td
								if robot.name.includes(' MK2')
									- var robotName = robot.name
									- robotName = robotName.replace(' MK2', '')
									- robotName = robotName.toLowerCase()
									img.rounded-sm(src='/images/icon_mech_#{robotName}_mk2_mini.png', alt='#{robot.name}')
								else if robot.name.includes(' PR')
									- var robotName = robot.name
									- robotName = robotName.replace(' PR', '')
									- robotName = robotName.toLowerCase()
									img.rounded-sm(src='/images/icon_mech_#{robotName}_pr_mini.png', alt='#{robot.name}')
								else
									img.rounded-sm(src='/images/icon_mech_#{robot.name.toLowerCase()}_mini.png', alt='#{robot.name}')
							td 
								a(href='/robots?id=#{robot.id}') #{robot.name}
							td #{totalKills}
							td #{totalLosses}
	.row.float-right
		.col-md-12
			nav
				ul.pagination.float-right
					if robots.hasPrevPage
						li.page-item
							a.page-link(href='/robots?page=1&limit=10') First
						li.page-item
							a.page-link(href='/robots?page=#{robots.page - 1}&limit=10') <<
					if robots.page >= 4
						li.page-item
							a.page-link(href='/robots?page=#{robots.page - 3}&limit=10') #{robots.page - 3}
					if robots.page >= 3
						li.page-item
							a.page-link(href='/robots?page=#{robots.page - 2}&limit=10') #{robots.page - 2}
					if robots.page >= 2
						li.page-item
							a.page-link(href='/robots?page=#{robots.page - 1}&limit=10') #{robots.page - 1}
					li.page-item.active
						a.page-link(href='/robots?page=#{robots.page}&limit=10') #{robots.page}
					if robots.page <= robots.totalPages - 1
						li.page-item
							a.page-link(href='/robots?page=#{robots.page + 1}&limit=10') #{robots.page + 1}
					if robots.page <= robots.totalPages - 2
						li.page-item
							a.page-link(href='/robots?page=#{robots.page + 2}&limit=10') #{robots.page + 2}
					if robots.page <= robots.totalPages - 3
						li.page-item
							a.page-link(href='/robots?page=#{robots.page + 3}&limit=10') #{robots.page + 3}
					if robots.hasNextPage
						li.page-item
							a.page-link(href='/robots?page=#{robots.page + 1}&limit=10') >>
						li.page-item
							a.page-link(href='/robots?page=#{robots.totalPages}&limit=10') Last
			p.float-right Total Robots: #{robots.totalDocs}